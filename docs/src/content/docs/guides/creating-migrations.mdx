---
title: Creating Migrations
description: Learn how to create database migrations in structure-ts
---
import { Code } from '@astrojs/starlight/components';

Migrations are version control for your database schema. This guide explains how to create migrations that track changes to your database structure.

## What are Migrations?

**Migrations** are files that define changes to your database schema:
- Creating tables
- Adding/removing columns
- Changing column types
- Adding indexes
- Modifying constraints

Think of migrations as Git commits for your database structure.

## Why Use Migrations?

### Without Migrations

<Code
  code={
    `// Change your model
const User = Model('user', {
    newField: {
      type: 'string',
      required: true,
      min: 2,
      max: 100,
    }, // Added this
});`
  }
  title='src/users/models.ts'
  lang="ts"
  mark={['newField']}
/>

**Problem:** Database doesn't know about the new field!

### With Migrations

1. Change your model
2. Create migration
3. Run migration
4. Database updated ✓

**Benefits:**
- Track schema changes over time
- Share changes with team
- Apply changes consistently across environments
- Rollback changes if needed

## When to Create Migrations

Create a migration when you:
- ✅ Create a new model
- ✅ Add/remove fields from models
- ✅ Change field types or constraints
- ✅ Add indexes or relationships
- ✅ Rename tables or columns

Don't need migrations for:
- ❌ Changing controller logic
- ❌ Updating routes
- ❌ Modifying business logic

## Creating Your First Migration

### Step 1: Create a Model

<Code
  code={
    `import { Model } from 'structure-ts';

const User = Model('user', {
    name: {
      type: 'string',
      required: true,
      min: 2,
      max: 100,
    },
    email: {
      type: 'email',
      unique: true,
      required: true,
    },
    password: {
      type: 'string',
      required: true,
      select: false,
    },
});

export { User };`
  }
  lang='ts'
  title='src/users/models.ts'
/>

### Step 2: Generate Migration

Run the CLI command:

<Code
  code={
    `st create db:migration`
  }
  lang='sh'
  title='terminal'
/>

or

<Code
  code={
    `structure-ts create db:migration`
  }
  lang='sh'
  title='terminal'
/>

if you want you can give also name

<Code
  code={
    `st create db:migration user-table`
  }
  lang='sh'
  title='terminal'
/>

### Step 3: Review the Migration

Open the generated file:

generely find in `.migrations/sql` untill change in settings

## change migration directly

<Code
  code={
    `export default {
    PORT,
    APPS,
    DATABASE,
    TEMPLATE_DIR,
    MIGRATION: {
      TABLE: 'tests',
      PATH: '.migrations',
    },
} satisfies SettingsType
`
  }
  lang='ts'
  title='src/settings.ts'
  mark={[
    `MIGRATION: {`,`  TABLE: 'tests',`,`  PATH: '.migrations'`,`},`
  ]}
/>

## Next Steps

Now that you've created migrations:

- **[Running Migrations](/guides/running-migrations/)** - Apply migrations to database
