---
title: Database Setup
description: Configure database connections in StratusTS
---
import { Code } from '@astrojs/starlight/components';

This guide walks you through configuring database connections in StratusTS, from choosing a database to testing your connection.

## Overview

StratusTS supports multiple database systems:
- **SQLite** - File-based, zero-configuration
- **PostgreSQL** - Robust, production-ready
- **MySQL** - Popular, widely supported
- **MariaDB** - MySQL fork with extra features
- **MongoDB** - NoSQL document database

## Choosing a Database

### SQLite - Best for Development

**Perfect for:**
- Learning and prototyping
- Development environment
- Small applications
- Single-user apps

**Pros:**
- No server setup required
- Just a file on your computer
- Instant start
- Great for beginners

**Cons:**
- Limited concurrent writes
- Not ideal for production at scale
- Fewer features than PostgreSQL

**When to use:** Getting started, prototypes, development

### PostgreSQL - Best for Production

**Perfect for:**
- Production applications
- Complex queries
- Large datasets
- Team projects

**Pros:**
- Extremely reliable
- Feature-rich
- Excellent performance
- Great community

**Cons:**
- Requires server setup
- More complex than SQLite

**When to use:** Serious applications, production environments

### MySQL/MariaDB - Popular Alternative

**Perfect for:**
- Web applications
- WordPress-style projects
- Shared hosting

**Pros:**
- Widely supported
- Familiar to many developers
- Good hosting options

**Cons:**
- Less feature-rich than PostgreSQL
- Some licensing considerations (MySQL)

**When to use:** Traditional web hosting, familiar with MySQL

### MongoDB - NoSQL Option

**Perfect for:**
- Flexible schemas
- Document-based data
- Rapid iteration

**Pros:**
- Schema flexibility
- JSON-like documents
- Horizontal scaling

**Cons:**
- Different paradigm (NoSQL)
- Less structured

**When to use:** Dynamic schemas, document storage

## No Database Configuration

If you don't need a database:

<Code
  code={
    `const DATABASE: DatabaseType = false;`
  }
  title={'src/settings.ts'}
  lang="ts"
  mark={['const DATABASE: DatabaseType = false;']}
/>

**Use cases:**
- Pure API proxy
- External database via API
- Microservices that don't store data

Your app starts faster without database overhead.

## SQLite Configuration

### Basic Setup

<Code
  code={
    `const DATABASE: DatabaseType = {
    config:{
      engine: 'sqlite',
      path: './database.sqlite'
    },
    onSuccess:()=>{
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
  mark={[`config`,`engine: 'sqlite'`,`path: './database.sqlite'`]}
/>

### What Happens

1. Creates `database.sqlite` file in your project root
2. Stores all data in this single file
3. No server or credentials needed

### File Location Options


<Code
  code={
    `// Root directory (default)
database: 'database.sqlite'

// Specific directory
database: './data/app.db'

// Inside src
database: './src/database.sqlite' // Don't do this`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### In-Memory Database (Testing)

:::note[Note]
This isn't tested yet <br/>
Use With Warning
:::

<Code
  code={
    `const DATABASE: DatabaseType = {
    config:{
      engine: 'sqlite',
      path: ':memory:'
    },
    onSuccess:()=>{
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
  mark={[`path: ':memory:'`]}
/>

**Use case:** Unit tests - database resets after each test run.

### Complete SQLite Example

<Code
  code={
    `import type { DatabaseType, SettingsType } from 'stratus-ts';

const PORT = 2000;
const APPS = ['users', 'blog'];

const DATABASE: DatabaseType = {
    config:{
      engine: 'sqlite',
      path: ':memory:'
    },
    onSuccess:()=>{
      console.log('database connected successfully')
    }
}

const TEMPLATE_DIR = 'templates';

export default {
    PORT,
    APPS,
    DATABASE,
    TEMPLATE_DIR,
} satisfies SettingsType;`
  }
  title={'src/settings.ts'}
  lang="ts"
  mark={[`path: ':memory:'`]}
/>

## PostgreSQL Configuration

Make Sure you are running postgre

### Installation

To Install **[Postgres](https://www.postgresql.org/download/)**
Or use **[Docker](https://hub.docker.com/_/postgres)** to run postgre

### Create Database

<Code
  code={
    `# Login as postgres user
sudo -u postgres psql

# Inside psql:
CREATE DATABASE mydb;

CREATE USER myuser WITH PASSWORD 'secure_password';

GRANT ALL PRIVILEGES ON DATABASE mydb TO myuser;

\\q`
  }
  title={'terminal'}
  lang="sh"
/>

### Basic Configuration

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'postgre',
      host: 'localhost',
      port: 5432,
      user:'myuser',
      password: 'secure_password',
      database: 'mydb',
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### Using Environment Variables (Recommended)

Create `.env` file:

<Code
  code={
    `DB_HOST=localhost
DB_PORT=5432
DB_USER=myuser
DB_PASSWORD=secure_password
DB_NAME=mydb`
  }
  title={'.env'}
  lang="sh"
/>

Update settings:

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'postgre',
      host: process.env.DB_HOST!,
      port: parseInt(process.env.DB_PORT!),
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      database: process.env.DB_NAME!,
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>


**Don't forget:** Add `.env` to `.gitignore`!

<Code
  code={
    `.env
.env.*`
  }
  title={'.gitignore'}
  lang="txt"
/>

## MySQL Configuration

Make Sure you are running MySQL

### Installation

To Install **[MySQL](https://www.mysql.com/downloads/)**
Or use **[Docker](https://hub.docker.com/_/mysql)** to run MySQL

### Create Database

<Code
  code={
    `# Login to MySQL
mysql -u root -p

# Inside MySQL:
CREATE DATABASE mydb;

CREATE USER 'myuser'@'localhost' IDENTIFIED BY 'secure_password';

GRANT ALL PRIVILEGES ON mydb.* TO 'myuser'@'localhost';

FLUSH PRIVILEGES;

EXIT;`
  }
  title={'terminal'}
  lang="sh"
/>

### Basic Configuration

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'mysql',
      host: 'localhost',
      port: 5432,
      user:'myuser',
      password: 'secure_password',
      database: 'mydb',
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### Using Environment Variables (Recommended)

Create `.env` file:

<Code
  code={
    `DB_HOST=localhost
DB_PORT=5432
DB_USER=myuser
DB_PASSWORD=secure_password
DB_NAME=mydb`
  }
  title={'.env'}
  lang="sh"
/>

Update settings:

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'mysql',
      host: process.env.DB_HOST!,
      port: parseInt(process.env.DB_PORT!),
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      database: process.env.DB_NAME!,
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

## MariaDB Configuration

**This is not implement yet**

## MongoDB Configuration

Make Sure you are running MongoDB

### Installation

To Install **[MongoDB](https://www.mongodb.com/try/download/community)**
Or use **[Docker](https://hub.docker.com/_/mongo)** to run MongoDB

### Basic Configuration

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'mongo',
      uri:'mongodb://localhost:27017',
      db:'mydb'
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### Using Environment Variables (Recommended)

Create `.env` file:

<Code
  code={
    `DB_URI="mongodb://localhost:27017"
DB_NAME=mydb`
  }
  title={'.env'}
  lang="sh"
/>

Update settings:

<Code
  code={
    `const DATABASE: DatabaseType = {
    config: {
      engine: 'mongo',
      uri: process.env.DB_URI!,
      db: process.env.DB_NAME!,
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### MongoDB Atlas (Cloud)

<Code
  code={
    `DB_URI="mongodb+srv://user:password@cluster.mongodb.net/"
DB_NAME=mydb`
  }
  title={'.env'}
  lang="sh"
/>

## Environment-Specific Configuration

### Development vs Production

<Code
  code={
    `const isProduction = process.env.ENV !== 'prod';
    
const DATABASE: DatabaseType = !isProduction ? {
    config:{
      engine: 'sqlite',
      path: './database.sqlite'
    },
    onSuccess:()=>{
      console.log('database connected successfully')
    }
} : {
    config: {
      engine: 'postgre',
      host: process.env.DB_HOST!,
      port: parseInt(process.env.DB_PORT!),
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      database: process.env.DB_NAME!,
    },
    onSuccess: () => {
      console.log('database connected successfully')
    }
}`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### Multiple Environments

<Code
  code={
    `const environment = process.env.ENV || 'dev';

const databaseConfig = {
    dev: {
      engine: 'sqlite' as const,
      path: './database.sqlite'
    },
  
    stag: {
      engine: 'postgre' as const,
      host: process.env.DB_HOST!,
      port: parseInt(process.env.DB_PORT!),
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      database: process.env.DB_NAME!,
    },
    
    prod: {
      engine: 'postgre' as const,
      host: process.env.DB_HOST!,
      port: parseInt(process.env.DB_PORT!),
      user: process.env.DB_USER!,
      password: process.env.DB_PASSWORD!,
      database: process.env.DB_NAME!,
    },
};

const DATABASE: DatabaseType = 
    databaseConfig[environment as keyof typeof databaseConfig];`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

## Advanced Options

### Logging SQL Queries

{/* ! TODO */}

:::note[Note]
This isn't implemented yet <br/>
:::

{/* 
```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  host: 'localhost',
  port: 5432,
  username: 'myapp_user',
  password: 'password',
  database: 'myapp_db',
  logging: true,  // Log all SQL queries to console
};
```

**Use for:** Debugging, development

**Don't use in:** Production (performance impact)

### Synchronize Schema (Dangerous!)

```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  // ... other config
  synchronize: true,  // ⚠️ Auto-sync schema with models
};
```

**⚠️ Warning:** 
- Never use in production!
- Can cause data loss
- Use migrations instead

**Only for:** Quick prototyping, development

### Connection Timeout

```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  // ... other config
  connectTimeoutMS: 10000,  // 10 seconds
};
```

### Charset (MySQL)

```typescript
const DATABASE: DatabaseType = {
  type: 'mysql',
  // ... other config
  charset: 'utf8mb4',  // Support emojis and international characters
};
```
*/}
## Testing Your Connection

### Start Your Server

<Code
  code={
    `pnpm dev # or npm run dev`
  }
  title={'terminal'}
  lang="sh"
/>

### Check Console Output

**Success:**

<Code
  code={
    `database connected successfully
server running on port : 2000`
  }
  title={'node'}
  lang="sh"
/>

**Failure:**

<Code
  code={
    `Database connection failed: <error message>`
  }
  title={'node'}
  lang="sh"
/>

## Troubleshooting

### "Connection Refused" Error

**Causes:**
- Database server not running
- Wrong host/port
- Firewall blocking connection

**Solutions:**
<Code
  code={
    `# Check if PostgreSQL is running
brew services list  # macOS
sudo systemctl status postgresql  # Linux

# Start the service
brew services start postgresql  # macOS
sudo systemctl start postgresql  # Linux

# Check port is listening
sudo lsof -i :5432  # PostgreSQL
sudo lsof -i :3306  # MySQL`
  }
  title={'terminal'}
  lang="sh"
/>

### "Authentication Failed" Error

**Causes:**
- Wrong username/password
- User doesn't have permissions
- Wrong authentication method

**Solutions:**

<Code
  code={
    `# PostgreSQL: Reset password
sudo -u postgres psql
ALTER USER myuser WITH PASSWORD 'new_password';

# MySQL: Reset password
mysql -u root -p
ALTER USER 'myuser'@'localhost' IDENTIFIED BY 'new_password';`
  }
  title={'terminal'}
  lang="sh"
/>

### "Database Does Not Exist" Error

**Solution:** Create the database manually:

<Code
  code={
    `sudo -u postgres psql
CREATE DATABASE mydb;

# MySQL
mysql -u root -p
CREATE DATABASE mydb;`
  }
  title={'terminal'}
  lang="sh"
/>

{/* 
### "Too Many Connections" Error

**Solution:** Increase connection limit or reduce pool size:

```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  // ... other config
  extra: {
    max: 5,  // Reduce from default
  },
};
```

### SSL Certificate Issues

**Solution:** Allow self-signed certificates:

```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  // ... other config
  ssl: {
    rejectUnauthorized: false,
  },
};
``` */}

{/* ### Connection Timeout

**Solution:** Increase timeout:

```typescript
const DATABASE: DatabaseType = {
  type: 'postgres',
  // ... other config
  connectTimeoutMS: 30000,  // 30 seconds
};
``` */}

## Best Practices

### 1. Never Commit Credentials


❌ **Don't:**

<Code
  code={
    `password: 'my_secret_password',  // In version control!`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

✅ **Do:**

<Code
  code={
    `password: process.env.DB_PASSWORD || ''`
  }
  title={'src/settings.ts'}
  lang="ts"
/>

### 2. Use Different Databases per Environment

<Code
  code={
    `development → SQLite or local PostgreSQL
staging → Staging PostgreSQL server
production → Production PostgreSQL server`
  }
  lang="txt"
/>

### 3. Use Migrations, Do Not modify database directly

Let migrations handle schema changes.

{/* ! TODO */}
{/* ### 7. Handle Connection Errors Gracefully

```typescript
try {
  await database.connect();
} catch (error) {
  console.error('Database connection failed:', error);
  process.exit(1);
}
``` */}

## Next Steps

Now that your database is configured:

- **[Migrations](/guides/creating-migrations/)** - Create migrations form your Models
